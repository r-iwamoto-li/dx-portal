<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DX PORTAL - Legacy Splash</title>
<style>
html,body{height:100%;margin:0}
body{font:14px/1.6 "MS UI Gothic","MS Sans Serif",system-ui,sans-serif;color:#000;background:#fff;overflow:hidden}

/* ==== 常時のCRT感（控えめ） ==== */
.crt{position:fixed;inset:0;pointer-events:none;z-index:2;
  background:radial-gradient(ellipse at center,rgba(0,0,0,0) 60%,rgba(0,0,0,.16) 96%),
             repeating-linear-gradient(0deg,rgba(0,0,0,.045) 0 2px,transparent 3px 4px);
  mix-blend-mode:multiply}

/* ==== レガシーUI（前回と同じ・一部省略） ==== */
#desk{position:fixed;inset:0;display:grid;grid-template-rows:auto 1fr auto;z-index:0}
.banner{background:#000080;color:#fff;padding:6px 10px;font-weight:700;display:flex;gap:10px;align-items:center;justify-content:space-between;box-shadow:inset 0 -2px 0 rgba(255,255,255,.25)}
.banner .marq{white-space:nowrap;overflow:hidden}
.banner .marq span{display:inline-block;padding-left:100%;animation:marq 22s linear infinite}
@keyframes marq{100%{transform:translateX(-100%)}}
.nav{display:flex;gap:8px;align-items:center}
.nav a{color:#fff;text-decoration:none;background:#1a45c5;padding:3px 8px;border:2px outset #7da3ff}
.nav a:hover{filter:brightness(1.1)}
.counter{font-weight:700}
.main{display:grid;grid-template-columns:260px 1fr 300px;gap:10px;padding:10px}
.box{background:#f8f8f8;border:3px groove #c0c0c0;padding:10px;min-height:0;overflow:auto}
.box h3{margin:0 0 6px;font-size:16px;border-bottom:2px inset #c0c0c0;padding-bottom:4px}
a.fake{color:#00f;text-decoration:underline}
a.fake:hover{text-decoration:none}
label,input,select,button{font:inherit}
input[type="text"]{border:2px inset #fff;padding:2px 4px;width:100%;background:#fff}
button.btn98{margin-top:6px;padding:6px 12px;background:#e0e0e0;color:#000;cursor:default;border:3px outset #fff;box-shadow:inset -2px -2px #808080,inset 2px 2px #fff}
button.btn98:hover{filter:brightness(1.05)}
button.btn98:active{border:3px inset #fff}
button[disabled]{opacity:.8;cursor:not-allowed}
.badge{display:inline-block;font-weight:700;background:#ff0;border:2px ridge #c0c000;padding:0 6px}
.kpi{display:grid;grid-template-columns:120px 1fr;gap:4px 8px;font-size:13px}
.kpi div:nth-child(odd){font-weight:700}
.foot{background:#f0f0f0;border-top:3px ridge #c0c0c0;padding:6px 10px;text-align:center}

/* ==== クラッシュ演出（ひび無し／水平ノイズ） ==== */
.fx{position:fixed;inset:0;pointer-events:none;z-index:5}
.fx .bars{position:absolute;inset:0;opacity:0;
  background:
    repeating-linear-gradient(0deg,
      rgba(0,0,0,.22) 0 1px, transparent 1px 10px),         /* 黒の細ライン */
    repeating-linear-gradient(0deg,
      rgba(255,0,0,.22) 0 1px, transparent 1px 14px),       /* 赤 */
    repeating-linear-gradient(0deg,
      rgba(0,70,255,.22) 0 1px, transparent 1px 18px);      /* 青 */
  animation:barsMove .9s linear infinite}
@keyframes barsMove{from{background-position-y:0}to{background-position-y:220px}}
.fx .scan{position:absolute;inset:0;opacity:0;background:linear-gradient(transparent 50%,rgba(0,0,0,.08) 51%);background-size:100% 4px}
body.glitch-on .fx .bars{opacity:.55}
body.glitch-on .fx .scan{opacity:.35}

/* ==== Win98風エラー（傾きなし） ==== */
.err98{position:fixed;z-index:8;width:300px;background:#c0c0c0;border:3px outset #fff;color:#000;box-shadow:0 12px 24px rgba(0,0,0,.35);transform:translate(-50%,-50%)}
.err98 .title{background:#000080;color:#fff;padding:3px 6px;font-weight:700;font-size:13px}
.err98 .inner{background:#f0f0f0;border:3px ridge #c0c0c0;padding:10px}
.err98 .row{display:flex;align-items:center;gap:10px}
.xmark{width:18px;height:18px;background:#d00;color:#fff;border-radius:50%;display:grid;place-items:center;font-weight:900}
.btnbar{margin-top:10px;display:flex;gap:8px;justify-content:flex-end}
.small{font-size:12px;color:#333}

/* ==== 最終確認モーダル ==== */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:10}
.modal.show{display:flex}
.win98{min-width:320px;background:#c0c0c0;border:3px outset #fff;color:#000;box-shadow:0 20px 40px rgba(0,0,0,.35)}
.titlebar{background:#000080;color:#fff;padding:4px 8px;font-weight:700;display:flex;align-items:center;justify-content:space-between}
.titlebar .minibox{width:14px;height:14px;background:#c0c0c0;border:2px outset #fff}
.dialog{background:#f0f0f0;border:3px ridge #c0c0c0;padding:12px}
.btnrow{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}
.btn98{font:700 13px/1 "MS Sans Serif";padding:6px 14px;background:#e0e0e0;color:#000;border:3px outset #fff;box-shadow:inset -2px -2px #808080,inset 2px 2px #fff;cursor:pointer}
.btn98:active{border:3px inset #fff}

/* RWD */
@media (max-width:1100px){.main{grid-template-columns:1fr 1fr}}
@media (max-width:760px){.main{grid-template-columns:1fr}.err98{width:86vw}}
</style>
</head>
<body>

<!-- === 使い古しDXポータル（中身は前回と同等） === -->
<div id="desk">
  <div class="banner">
    <div class="nav">
      <a href="#" onclick="return false">HOME</a>
      <a href="#" onclick="return false">プロジェクト</a>
      <a href="#" onclick="return false">ナレッジ</a>
      <a href="#" onclick="return false">掲示板</a>
    </div>
    <div class="marq"><span>【重要】Internet Explorer 5.0をご利用の方へ：ActiveXの設定を更新してください —— DX Innovation News</span></div>
    <div class="counter">Visitors: 001,294,882</div>
  </div>

  <div class="main">
    <aside class="box">
      <h3>クイックリンク</h3>
      <ul style="margin:0 0 10px 18px">
        <li><a class="fake" href="#" onclick="return false">経営ダッシュボード</a></li>
        <li><a class="fake" href="#" onclick="return false">SFA入力マニュアル（Word97）</a></li>
        <li><a class="fake" href="#" onclick="return false">在庫一覧（CSV）</a></li>
        <li><a class="fake" href="#" onclick="return false">勤怠入力（要ActiveX）</a></li>
      </ul>
      <h3>サイト内検索</h3>
      <input type="text" placeholder="例）売上 日次" />
      <button class="btn98" disabled>検索</button>
      <p class="small">※検索は現在メンテナンス中です。</p>
    </aside>

    <main class="box">
      <h3>DXポータル（レガシー版）</h3>
      <p>長年ご利用ありがとうございます。資産の都合により機能の一部を縮小して運用しています。最新DXポータルは別系統にて提供中です。</p>
      <h3>更新履歴</h3>
      <ul style="margin:0 0 10px 18px">
        <li>2000-02-14 コンテンツミラーリング開始（夜間のみ）</li>
        <li>1999-10-01 KPIレポートに“交通費”項目を追加</li>
        <li>1999-07-07 BBSのスパム対策を実施（英数字のみ）</li>
        <li>1998-12-24 年末年始の運用体制について</li>
      </ul>
      <h3>お知らせ</h3>
      <div style="display:grid;gap:8px">
        <div style="background:#ffffcc;border:2px ridge #c0c000;padding:6px"><strong>注意：</strong> Netscape Navigator 4.7では一部表示が崩れます。</div>
        <div style="background:#e6f2ff;border:2px ridge #98b2e6;padding:6px">新入社員向けオンボーディング資料（PowerPoint 97）を公開しました。</div>
      </div>
    </main>

    <aside class="box">
      <h3>システム稼働状況</h3>
      <div class="kpi">
        <div>会計DWH</div><div>稼働中（遅延 12分）</div>
        <div>SFA</div><div>稼働中（警告）</div>
        <div>在庫DB</div><div>バックアップ中</div>
        <div>人事基盤</div><div>稼働中</div>
      </div>
      <h3 style="margin-top:10px">KPI（参考）</h3>
      <div class="kpi">
        <div>今月売上</div><div>¥ 128,443,200</div>
        <div>粗利率</div><div>34.1 %</div>
        <div>案件進捗</div><div>75 %</div>
      </div>
      <h3 style="margin-top:10px">スポンサー</h3>
      <div style="display:grid;gap:6px">
        <div style="background:#fff;border:3px outset #fff;padding:8px;text-align:center">🎉 <span class="badge">NEW</span> 社内掲示板 v2.0 β</div>
        <div style="background:#fff;border:3px outset #fff;padding:8px;text-align:center">📦 配送トラッキング（要Java）</div>
      </div>
    </aside>
  </div>

  <div class="foot">Copyright © 1998–2000 DX Portal — All rights reserved.</div>
</div>

<!-- オーバーレイ（ノイズのみ） -->
<div class="fx">
  <div class="bars"></div>
  <div class="scan"></div>
</div>
<div class="crt"></div>

<!-- 最終確認モーダル -->
<div id="popup" class="modal" aria-hidden="true">
  <div class="win98" role="dialog" aria-modal="true" aria-labelledby="ttl">
    <div class="titlebar"><span id="ttl">Microsoft Windows</span><span class="minibox" aria-hidden="true"></span></div>
    <div class="dialog">
      <p>DXポータルの最新バージョンに接続します。よろしいですか？</p>
      <div class="btnrow">
        <button id="ok" class="btn98">OK</button>
        <button id="cancel" class="btn98">Cancel</button>
      </div>
    </div>
  </div>
</div>

<script>
/* ===== 遷移先 ===== */
const DEST_URL = 'index.html';

/* ===== タイムライン ===== */
const T_GLITCH = 3000;          // クラッシュ開始
const T_POPUP_START_DELAY = 1200;
const ERR_TOTAL = 10;           // 個数
const ERR_INTERVAL = 140;       // 高速化（以前より速い）

setTimeout(() => {
  document.body.classList.add('glitch-on');
  setTimeout(() => rampErrorsGrid(ERR_TOTAL, ERR_INTERVAL), T_POPUP_START_DELAY);
}, T_GLITCH);

/* ===== 均等配置＋微ジッターでバラけさせる ===== */
function rampErrorsGrid(total=10, interval=140){
  const pad = 60;                          // 画面端の安全マージン
  const w = Math.max(320, innerWidth  - pad*2);
  const h = Math.max(220, innerHeight - pad*2);

  // グリッド数（画面比から列行数を決定）
  const cols = Math.ceil(Math.sqrt(total * (w/h)));
  const rows = Math.ceil(total / cols);

  const cellW = w / cols;
  const cellH = h / rows;

  // グリッド中心を並べ、軽いジッターを与えてシャッフル
  const points = [];
  let idx = 0;
  for(let r=0; r<rows; r++){
    for(let c=0; c<cols; c++){
      if(idx++ >= total) break;
      const cx = pad + c*cellW + cellW/2;
      const cy = pad + r*cellH + cellH/2;
      const jx = (Math.random()-0.5) * cellW * 0.55; // ほどよい散り
      const jy = (Math.random()-0.5) * cellH * 0.55;
      points.push([cx + jx, cy + jy]);
    }
  }
  // 表示順をランダム化
  shuffle(points);

  let i = 0;
  const timer = setInterval(()=>{
    const [x,y] = points[i++];
    createErrorWin(x,y);
    if(i>=points.length){ clearInterval(timer); setTimeout(showFinalModal, 700); }
  }, interval);
}

function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]] }}

/* Win98風エラー（そのまま） */
function createErrorWin(x,y){
  const el = document.createElement('div');
  el.className = 'err98';
  el.style.left = x + 'px';
  el.style.top  = y + 'px';
  el.innerHTML = `
    <div class="title">System Error</div>
    <div class="inner">
      <div class="row">
        <div class="xmark">×</div>
        <div>
          <div>Runtime error.</div>
          <div>Press Ok to Continue.</div>
          <div>Press Cancel to Quit.</div>
        </div>
      </div>
      <div class="btnbar">
        <button class="btn98">OK</button>
        <button class="btn98 close">Cancel</button>
      </div>
    </div>`;
  document.body.appendChild(el);
  el.querySelector('.close').addEventListener('click', ()=> el.remove());
}

/* 最終モーダル */
function showFinalModal(){
  const m = document.getElementById('popup');
  m.classList.add('show');
  m.setAttribute('aria-hidden','false');
}
document.getElementById('ok').addEventListener('click', ()=> location.href = DEST_URL);
document.getElementById('cancel').addEventListener('click', ()=> {
  document.getElementById('popup').classList.remove('show');
});
</script>

</body>
</html>
